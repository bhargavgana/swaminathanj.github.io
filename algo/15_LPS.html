<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>Longest Palindromic Subsequence</title>
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../styles.css" />
        <script type="text/javascript" src="../scripts/shCore.js"></script>
        <script type="text/javascript" src="../scripts/shBrushBash.js"></script>
        <script type="text/javascript" src="../scripts/shBrushCpp.js"></script>
        <script type="text/javascript" src="../scripts/shBrushCSharp.js"></script>
        <script type="text/javascript" src="../scripts/shBrushCss.js"></script>
        <script type="text/javascript" src="../scripts/shBrushDelphi.js"></script>
        <script type="text/javascript" src="../scripts/shBrushDiff.js"></script>
        <script type="text/javascript" src="../scripts/shBrushGroovy.js"></script>
        <script type="text/javascript" src="../scripts/shBrushJava.js"></script>
        <script type="text/javascript" src="../scripts/shBrushJScript.js"></script>
        <script type="text/javascript" src="../scripts/shBrushPhp.js"></script>
        <script type="text/javascript" src="../scripts/shBrushPlain.js"></script>
        <script type="text/javascript" src="../scripts/shBrushPython.js"></script>
        <script type="text/javascript" src="../scripts/shBrushRuby.js"></script>
        <script type="text/javascript" src="../scripts/shBrushScala.js"></script>
        <script type="text/javascript" src="../scripts/shBrushSql.js"></script>
        <script type="text/javascript" src="../scripts/shBrushVb.js"></script>
        <script type="text/javascript" src="../scripts/shBrushXml.js"></script>
        <link type="text/css" rel="stylesheet" href="lecture-notes.css"/>
        <link type="text/css" rel="stylesheet" href="../styles/shCore.css"/>
        <link type="text/css" rel="stylesheet" href="../styles/shThemeDefault.css"/>
        <script type="text/javascript">
            //SyntaxHighlighter.config.clipboardSwf = 'scripts/clipboard.swf';
            SyntaxHighlighter.defaults['toolbar'] = false;
            SyntaxHighlighter.defaults['auto-links'] = false;
 
            SyntaxHighlighter.all();
        </script>
</head>

<body>
 
<div id="container">
<div id="header"><h1>Design and Analysis of Algorithms<img align="right" src="../logo-dark.png" alt="Amrita"> </h1> </div>
  <div id="wrapper">
    <div id="content">

<table align="right">
  <td align="left"><a href="14_LIS.html">Prev</a></td>
  <td align="right"><a href="16_MSS.html">Next</a></td>
</table>

<h2>Longest Palindromic Subsequence</h2>

<p>Consider the string S[1..n] of characters. The goal is to find the longest palindromic subsequence in S.</p>

<h3>Example</h3>
<p>String S = a x b c y b z a. The longest palindromic subsequence is a b c b a of length 5.</p>

<h3>(1) Brute-force solution</h3>
<p>The brute-force way to solve this problem is to enumerate all possible subsequences and determine the one that
is longest and palindromic. For n elements, there are 2<sup>n</sup> subsequences possible.</p>

<p>The brute-force solution can be implemented using recursion given as follows. Let LPS(1..n) denote the length
of the longest palindromic subsequence for S.</p>

<pre class="brush: java">

	LPS(1..n) {
		if (n == 1)
			return 1

		if (S[1] == S[n])
			return 2 + LPS(2..n-1)
		else
			return max( LPS(1..n-1), LPS(2..n) )
	}
</pre>

<p>Checking the first and last chars of S opens two possibilities.</p>
<ul>
	<li><b>Case 1: S[1] = S[n]</b></li> <br>
	<p>This implies we found a palindrominc subsequence of length 2 plus whatever palindromic length that can be 
	achieved from the remaining characters of the substring S. i.e. S[2..n-1]. </p>

	<li><b>Case 2: S[1] &ne; S[n]</b></li> <br>
	<p>This implies that it is still possible for either S[1] or S[n] to be part of the palindromic subsequence.
	S[1] may match with S[n-1] or S[2] may match with S[n]. So, we look for the longest palindromic subsequence
	in both these substrings and pick the best. i.e. Best of S[1..n-1] and S[2..n].</p>
</ul>

<p>The recursion tree is shown below. Each call path from the root to the leaf gives one of the 2<sup>n</sup> 
subsequences. Let LPS(1,n) denote the length of the longest palindromic subsequence of the input S[1..n].</p> 

<pre>

                                        LPS(1,n)
                                            |
                                            |
                  S[1] = S[n]               |             S[1] &ne; S[n]
                ---------------------------------------------------------
                |                                                       | 
                |                                     -----------------MAX-----------------
                |                                     |                                   |
            2+LPS(2,n-1)                        LPS(1,n-1)                            LPS(2,n)
                |                                     |                                   |
                |                                     |                                   |
                |                                     |                                   |
  S[2] = S[n-1] | S[2] &ne; S[n-1]         S[1] = S[n-1] | S[1] &ne; S[n-1]         S[2] = S[n] | S[2] &ne; T[n]
    -----------------------                  -------------------                  --------------------
    |                     |                  |                 |                  |                  |           
    |               -----MAX-----            |            ----MAX----             |             ----MAX----
    |               |           |            |            |         |             |             |         |
2+LPS(3,n-2)   LPS(2,n-2)  LPS(3,n-1)   2+LPS(2,n-2)  LPS(1,n-2) LPS(2,n-1)  2+LPS(3,n-1)  LPS(2,n-1)  LPS(3,n)
    :               :           :            :            :         :             :             :         :
    :               :           :            :            :         :             :             :         :
    :               :           :            :            :         :             :             :         :


</pre>

<h4>Time complexity</h4>
<p>The recursive solution takes O(2<sup>n</sup>) time.</p>

<h3>(2) Greedy Solution - Does it exist?</h3>

<p>To apply greedy strategy we need to first check if the problem exhibits (i) optimal substructure property
and (ii) greedy choice property.</p>

<p><b>Optimal substructure</b>: The recursive fomulation above reveals the optimal substructure. The problem 
of finding LPS of S[1..n] contains within itself the subproblem of finding LPS of S[2..n], S[1..n-1] and
S[2..n-1].</p>

<p><b>Greedy choice property</b>: To check if a greedy solution exists or not, we need to determine if greedy 
choice property is satisfied. i.e. do we have any way to decide which of the 3 subproblems need to be solved
at each step?</p>

<p><b>Case 1: S[1] = S[n]</b>. If the first and the last char matches, we have a clear choice to solve the subproblem 
LPS(2,n-1). In the best case, the string S is a palindrome in itself, then the problem can be solved in n/2 steps. 
i.e. </p>

<ul>
	<p>LPS(1,n) = 2 + LPS(2,n-1) = 4 + LPS(3,n-2) = ...... = n-2 + LPS(n/2,n/2+1) = n + LPS(n/2+1,n/2) = n</p>
</ul>

<p>The recurrence equation in this case is: T(n) = T(n-2) + 1 = O(n).</p>

<p><b>Case 2: S[1] &ne; S[n]</b>. If the first and last chars don't match, we have solve to the two subproblems
LPS(1,n-1) and LPS(2,n) and pick the best of them. There is no clear choice to pick between the two subproblems.
In the worst case, at every step each problems breaks into two subproblems. The recurrence equation in this
case is:</p>

<ul>
	<p>T(n) = 2 T(n-1) + 2 = O(2<sup>n</sup>)</p>
</ul>

<p>Consequently, greedy solution does not exist.</p>


<h3>(3) Dynamic Programming Solution</h3>

<p>To apply dynamic programming, we need to check if the problem exhibits (i) optimal substructure and (ii)
overlapping subproblems.</p> 
<p>(i) We already saw above, that optimal substructure property holds.</p> 
<p>(ii) The recursive formulation also reveals the existence of overlapping subproblems such as LPS(2,n-1),
LPS(3,n-1) and LPS(2,n-2). In the complete tree of possibilities several overlapping problems exist.</p>

<p>The dynamic programming works in a bottom-up fashion. Subproblems are solved and their solutions are used to 
find solutions to larger problems. Hence, we work as follows.</p>
<ul>
	<li>If we picked one char of the string, what is the longest palindromic subsequence?</li>
	<li>If we picked two consecutive chars, what is the longest palindromic subsequence?.</li>
	<li>So on and so forth ... until n consecutive tasks which computes the optimal order for all tasks.</li>
</ul>

<p>Let LPS[i,j] denote the length of the longest palindromic subsequence in the substring S[i..j]. Initially, j = i. 
In the subsequent iterations, j takes the values of (i+1), (i+2), ..., (i+n-1). This can be consolidated by defining a special variable 'len' which takes values 0 through n-1 denoting the length of consecutive tasks considered for that iteration. And hence, j = i + len for len = 0...n-1. </p>

<ul>
	<li>In the first iteration len = 0, we find the optimal length for the range [i,i]. <br>
	i.e. LPS[1,1], LPS[2,2], ..., LPS[n,n]. &nbsp; &nbsp; &nbsp; (n computations)</li>
	<li>In the second iteration len = 1, we find the optimal length for the range [i,i+1]. <br>
	i.e. LPS[1,2], LPS[2,3], ..., LPS[n-1,n]. &nbsp; &nbsp; (n-1 computations)</li>
	<li>In the third iteration len = 2, we find the optimal length for the range [i,i+2]. <br>
	i.e. LPS[1,3], LPS[2,4], ..., LPS[n-2,n]. &nbsp; &nbsp; (n-2 computations)</li>
	<li>....</li>
	<li>....</li>
	<li>In the last but one iteration len = n-2, we find the optimal length for the range [i,i+n-2]. <br>
	i.e. LPS[1,n-1], LPS[2,n] &nbsp; &nbsp; &nbsp; (2 computations)</li>
	<li>In the last (n<sup>th</sup>) iteration len = n-1, we find the optimal length for [i,i+n-1]. <br>
	i.e. LPS[1,n]. &nbsp; &nbsp; &nbsp; &nbsp; (1 computation)</li>
</ul>

<p>The entire computation worked out above can be accomplished using the following nested loop.</p>

<ul>
	<p> for (len = 0; len < n; len++) { <br>
	&nbsp; &nbsp; for (i = 1; i <= n-len; i++) { <br>
	&nbsp; &nbsp; &nbsp; &nbsp; j = i + len <br>
	&nbsp; &nbsp; &nbsp; &nbsp; // Determine LPS[i,j] <br>
	&nbsp; &nbsp; &nbsp; &nbsp; ............. <br>
	&nbsp; &nbsp; &nbsp; &nbsp; ............. <br>
	&nbsp; &nbsp; } <br>
	}
	</p>
</ul>

<p><b>Iteration 1: len = 0; i = 1 to n; j = i+len = i;</b></p>
<p>Each char considered individually is a palindrome since it is both the first and last char. Hence, LPS[i,i] = 1.</p>

<p>Let us now work out for the given example.</p>
<ul>
	<p>S[1] = a --> LPS[1,1] = 1</p>
	<p>S[2] = x --> LPS[2,2] = 1</p>
	<p>S[3] = b --> LPS[3,3] = 1</p>
	<p>S[4] = c --> LPS[4,4] = 1</p>
	<p>S[5] = y --> LPS[5,5] = 1</p>
	<p>S[6] = b --> LPS[6,6] = 1</p>
	<p>S[7] = z --> LPS[7,7] = 1</p>
	<p>S[8] = a --> LPS[8,8] = 1</p>
</ul>

<ul>
	<table border="1">
		<tr bgcolor="lightgray">
			<td align="center"><br><b>i &nbsp; \ &nbsp; j</b><br><br></td>
			<td align="center">&nbsp;<b>j = 1</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 2</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 3</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 4</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 5</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 6</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 7</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 8</b>&nbsp;</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 1</b>&nbsp; &nbsp;</td>
			<td align="center" bgcolor="lightblue"><br>LPS[1,1] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"></td>
			<td align="center" bgcolor="cyan"></td>
			<td align="center" bgcolor="orange"></td>
			<td align="center" bgcolor="lightyellow"></td>
			<td align="center" bgcolor="lightpink"></td>
			<td align="center" bgcolor="skyblue"></td>
			<td align="center" bgcolor="gold"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 2</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[2,2] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"></td>
			<td align="center" bgcolor="cyan"></td>
			<td align="center" bgcolor="orange"></td>
			<td align="center" bgcolor="lightyellow"></td>
			<td align="center" bgcolor="lightpink"></td>
			<td align="center" bgcolor="skyblue"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 3</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[3,3] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"></td>
			<td align="center" bgcolor="cyan"></td>
			<td align="center" bgcolor="orange"></td>
			<td align="center" bgcolor="lightyellow"></td>
			<td align="center" bgcolor="lightpink"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 4</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[4,4] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"></td>
			<td align="center" bgcolor="cyan"></td>
			<td align="center" bgcolor="orange"></td>
			<td align="center" bgcolor="lightyellow"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 5</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[5,5] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"></td>
			<td align="center" bgcolor="cyan"></td>
			<td align="center" bgcolor="orange"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 6</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[6,6] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"></td>
			<td align="center" bgcolor="cyan"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 7</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[7,7] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 8</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[8,8] = 1<br><br></td>
		</tr>
	</table>
</ul>

<p><b>Iteration 2: len = 1; i = 1 to n-len; j = i+len = i+1;</b></p>
<p>In this iteration we consider two consecutive chars. If they are same, then LPS[i,i+1] = 2. If they are not,
LPS[i,i+1] = max{LPS[i,i], LPS[i+1,i+1]} = max{1,1} = 1.</p>

<p>Let us now work out for the given example.</p>
<ul>
	<p>S[1..2] = ax --> LPS[1,2] = max{LPS[1,1], LPS[2,2]} = max{1,1} = 1</p>
	<p>S[2..3] = xb --> LPS[2,3] = max{LPS[2,2], LPS[3,3]} = max{1,1} = 1</p>
	<p>S[3..4] = bc --> LPS[3,4] = max{LPS[3,3], LPS[4,4]} = max{1,1} = 1</p>
	<p>S[4..5] = cy --> LPS[4,5] = max{LPS[4,4], LPS[5,5]} = max{1,1} = 1</p>
	<p>S[5..6] = yb --> LPS[5,6] = max{LPS[5,5], LPS[6,6]} = max{1,1} = 1</p>
	<p>S[6..7] = bz --> LPS[6,7] = max{LPS[6,6], LPS[7,7]} = max{1,1} = 1</p>
	<p>S[7..8] = za --> LPS[7,8] = max{LPS[7,7], LPS[8,8]} = max{1,1} = 1</p>
</ul>

<ul>
	<table border="1">
		<tr bgcolor="lightgray">
			<td align="center"><br><b>i &nbsp; \ &nbsp; j</b><br><br></td>
			<td align="center">&nbsp;<b>j = 1</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 2</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 3</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 4</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 5</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 6</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 7</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 8</b>&nbsp;</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 1</b>&nbsp; &nbsp;</td>
			<td align="center" bgcolor="lightblue"><br>LPS[1,1] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[1,2] = 1</td>
			<td align="center" bgcolor="cyan"></td>
			<td align="center" bgcolor="orange"></td>
			<td align="center" bgcolor="lightyellow"></td>
			<td align="center" bgcolor="lightpink"></td>
			<td align="center" bgcolor="skyblue"></td>
			<td align="center" bgcolor="gold"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 2</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[2,2] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[2,3] = 1</td>
			<td align="center" bgcolor="cyan"></td>
			<td align="center" bgcolor="orange"></td>
			<td align="center" bgcolor="lightyellow"></td>
			<td align="center" bgcolor="lightpink"></td>
			<td align="center" bgcolor="skyblue"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 3</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[3,3] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[3,4] = 1</td>
			<td align="center" bgcolor="cyan"></td>
			<td align="center" bgcolor="orange"></td>
			<td align="center" bgcolor="lightyellow"></td>
			<td align="center" bgcolor="lightpink"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 4</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[4,4] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[4,5] = 1</td>
			<td align="center" bgcolor="cyan"></td>
			<td align="center" bgcolor="orange"></td>
			<td align="center" bgcolor="lightyellow"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 5</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[5,5] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[5,6] = 1</td>
			<td align="center" bgcolor="cyan"></td>
			<td align="center" bgcolor="orange"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 6</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[6,6] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[6,7] = 1</td>
			<td align="center" bgcolor="cyan"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 7</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[7,7] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[7,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 8</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[8,8] = 1<br><br></td>
		</tr>
	</table>
</ul>

<p><b>Iteration 3: len = 2; i = 1 to n-len; j = i+len = i+2;</b></p>
<p>In this iteration we consider three consecutive chars. If the first and third chars are same, then</p>
<ul>
	LPS[i,j] = LPS[i,i+2] = 2 + LPS[i+1,i+1] = 2 + 1 = 3. 
</ul>
<p>If they are not the same,</p>
<ul>
	<p>LPS[i,j] = LPS[i,i+2] = max{LPS[i,i+1], LPS[i+1,i+2]}</p>
</ul>

<p>Let us now work out for the given example.</p>
<ul>
	<p>S[1..3] = axb --> LPS[1,3] = max{LPS[1,2], LPS[2,3]} = max{1,1} = 1</p>
	<p>S[2..4] = xbc --> LPS[2,4] = max{LPS[2,3], LPS[3,4]} = max{1,1} = 1</p>
	<p>S[3..5] = bcy --> LPS[3,5] = max{LPS[3,4], LPS[4,5]} = max{1,1} = 1</p>
	<p>S[4..6] = cyb --> LPS[4,6] = max{LPS[4,5], LPS[5,6]} = max{1,1} = 1</p>
	<p>S[5..7] = ybz --> LPS[5,7] = max{LPS[5,6], LPS[6,7]} = max{1,1} = 1</p>
	<p>S[6..8] = bza --> LPS[6,8] = max{LPS[6,7], LPS[7,8]} = max{1,1} = 1</p>
</ul>

<ul>
	<table border="1">
		<tr bgcolor="lightgray">
			<td align="center"><br><b>i &nbsp; \ &nbsp; j</b><br><br></td>
			<td align="center">&nbsp;<b>j = 1</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 2</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 3</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 4</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 5</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 6</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 7</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 8</b>&nbsp;</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 1</b>&nbsp; &nbsp;</td>
			<td align="center" bgcolor="lightblue"><br>LPS[1,1] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[1,2] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[1,3] = 1</td>
			<td align="center" bgcolor="orange"></td>
			<td align="center" bgcolor="lightyellow"></td>
			<td align="center" bgcolor="lightpink"></td>
			<td align="center" bgcolor="skyblue"></td>
			<td align="center" bgcolor="gold"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 2</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[2,2] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[2,3] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[2,4] = 1</td>
			<td align="center" bgcolor="orange"></td>
			<td align="center" bgcolor="lightyellow"></td>
			<td align="center" bgcolor="lightpink"></td>
			<td align="center" bgcolor="skyblue"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 3</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[3,3] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[3,4] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[3,5] = 1</td>
			<td align="center" bgcolor="orange"></td>
			<td align="center" bgcolor="lightyellow"></td>
			<td align="center" bgcolor="lightpink"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 4</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[4,4] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[4,5] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[4,6] = 1</td>
			<td align="center" bgcolor="orange"></td>
			<td align="center" bgcolor="lightyellow"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 5</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[5,5] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[5,6] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[5,7] = 1</td>
			<td align="center" bgcolor="orange"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 6</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[6,6] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[6,7] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[6,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 7</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[7,7] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[7,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 8</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[8,8] = 1<br><br></td>
		</tr>
	</table>
</ul>

<p><b>Iteration 4: len = 3; i = 1 to n-len; j = i+len = i+3;</b></p>
<p>In this iteration we consider four consecutive chars. If the first (i<sup>th</sup>) and last (j<sup>th</sup>) 
chars are same, then</p>
<ul>
	LPS[i,j] = 2 + LPS[i+1,j-1] 
</ul>
<p>If they are not the same,</p>
<ul>
	<p>LPS[i,j] = max{LPS[i,j-1], LPS[i+1,j]}</p>
</ul>

<p>Let us now work out for the given example.</p>
<ul>
	<p>S[1..4] = axbc --> LPS[1,4] = max{LPS[1,3], LPS[2,4]} = max{1,1} = 1</p>
	<p>S[2..5] = xbcy --> LPS[2,5] = max{LPS[2,4], LPS[3,5]} = max{1,1} = 1</p>
	<p>S[3..6] = bcyb --> LPS[3,6] = 2 + LPS[4,5] = 2 + 1 = 3</p>
	<p>S[4..7] = cybz --> LPS[4,7] = max{LPS[4,6], LPS[5,7]} = max{1,1} = 1</p>
	<p>S[5..8] = ybza --> LPS[5,8] = max{LPS[5,7], LPS[6,8]} = max{1,1} = 1</p>
</ul>

<ul>
	<table border="1">
		<tr bgcolor="lightgray">
			<td align="center"><br><b>i &nbsp; \ &nbsp; j</b><br><br></td>
			<td align="center">&nbsp;<b>j = 1</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 2</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 3</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 4</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 5</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 6</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 7</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 8</b>&nbsp;</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 1</b>&nbsp; &nbsp;</td>
			<td align="center" bgcolor="lightblue"><br>LPS[1,1] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[1,2] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[1,3] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[1,4] = 1</td>
			<td align="center" bgcolor="lightyellow"></td>
			<td align="center" bgcolor="lightpink"></td>
			<td align="center" bgcolor="skyblue"></td>
			<td align="center" bgcolor="gold"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 2</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[2,2] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[2,3] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[2,4] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[2,5] = 1</td>
			<td align="center" bgcolor="lightyellow"></td>
			<td align="center" bgcolor="lightpink"></td>
			<td align="center" bgcolor="skyblue"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 3</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[3,3] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[3,4] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[3,5] = 1</td>
			<td align="center" bgcolor="orange"><br><b>LPS[3,6] = 3</b></td>
			<td align="center" bgcolor="lightyellow"></td>
			<td align="center" bgcolor="lightpink"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 4</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[4,4] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[4,5] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[4,6] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[4,7] = 1</td>
			<td align="center" bgcolor="lightyellow"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 5</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[5,5] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[5,6] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[5,7] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[5,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 6</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[6,6] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[6,7] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[6,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 7</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[7,7] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[7,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 8</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[8,8] = 1<br><br></td>
		</tr>
	</table>
</ul>

<p><b>Iteration 5: len = 4; i = 1 to n-len; j = i+len = i+4;</b></p>
<p>In this iteration we consider five consecutive chars. If the first (i<sup>th</sup>) and last (j<sup>th</sup>) 
chars are same, then</p>
<ul>
	LPS[i,j] = 2 + LPS[i+1,j-1] 
</ul>
<p>If they are not the same,</p>
<ul>
	<p>LPS[i,j] = max{LPS[i,j-1], LPS[i+1,j]}</p>
</ul>

<p>Let us now work out for the given example.</p>
<ul>
	<p>S[1..5] = axbcy --> LPS[1,5] = max{LPS[1,4], LPS[2,5]} = max{1,1} = 1</p>
	<p>S[2..6] = xbcyb --> LPS[2,6] = max{LPS[2,5], LPS[3,6]} = max{1,3} = 3</p>
	<p>S[3..7] = bcybz --> LPS[3,7] = max{LPS[3,6], LPS[4,7]} = max{3,1} = 3</p>
	<p>S[4..8] = cybza --> LPS[4,8] = max{LPS[4,7], LPS[5,8]} = max{1,1} = 1</p>
</ul>

<ul>
	<table border="1">
		<tr bgcolor="lightgray">
			<td align="center"><br><b>i &nbsp; \ &nbsp; j</b><br><br></td>
			<td align="center">&nbsp;<b>j = 1</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 2</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 3</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 4</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 5</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 6</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 7</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 8</b>&nbsp;</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 1</b>&nbsp; &nbsp;</td>
			<td align="center" bgcolor="lightblue"><br>LPS[1,1] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[1,2] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[1,3] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[1,4] = 1</td>
			<td align="center" bgcolor="lightyellow"><br>LPS[1,5] = 1</td>
			<td align="center" bgcolor="lightpink"></td>
			<td align="center" bgcolor="skyblue"></td>
			<td align="center" bgcolor="gold"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 2</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[2,2] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[2,3] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[2,4] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[2,5] = 1</td>
			<td align="center" bgcolor="lightyellow"><br>LPS[2,6] = 3</td>
			<td align="center" bgcolor="lightpink"></td>
			<td align="center" bgcolor="skyblue"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 3</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[3,3] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[3,4] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[3,5] = 1</td>
			<td align="center" bgcolor="orange"><br><b>LPS[3,6] = 3</b></td>
			<td align="center" bgcolor="lightyellow"><br>LPS[3,7] = 3</td>
			<td align="center" bgcolor="lightpink"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 4</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[4,4] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[4,5] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[4,6] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[4,7] = 1</td>
			<td align="center" bgcolor="lightyellow"><br>LPS[4,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 5</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[5,5] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[5,6] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[5,7] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[5,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 6</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[6,6] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[6,7] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[6,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 7</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[7,7] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[7,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 8</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[8,8] = 1<br><br></td>
		</tr>
	</table>
</ul>

<p><b>Iteration 6: len = 5; i = 1 to n-len; j = i+len = i+5;</b></p>
<p>In this iteration we consider six consecutive chars. If the first (i<sup>th</sup>) and last (j<sup>th</sup>) 
chars are same, then</p>
<ul>
	LPS[i,j] = 2 + LPS[i+1,j-1] 
</ul>
<p>If they are not the same,</p>
<ul>
	<p>LPS[i,j] = max{LPS[i,j-1], LPS[i+1,j]}</p>
</ul>

<p>Let us now work out for the given example.</p>
<ul>
	<p>S[1..6] = axbcyb --> LPS[1,6] = max{LPS[1,5], LPS[2,6]} = max{1,3} = 3</p>
	<p>S[2..7] = xbcybz --> LPS[2,7] = max{LPS[2,6], LPS[3,7]} = max{3,3} = 3</p>
	<p>S[3..8] = bcybza --> LPS[3,8] = max{LPS[3,7], LPS[4,8]} = max{3,1} = 3</p>
</ul>

<ul>
	<table border="1">
		<tr bgcolor="lightgray">
			<td align="center"><br><b>i &nbsp; \ &nbsp; j</b><br><br></td>
			<td align="center">&nbsp;<b>j = 1</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 2</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 3</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 4</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 5</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 6</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 7</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 8</b>&nbsp;</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 1</b>&nbsp; &nbsp;</td>
			<td align="center" bgcolor="lightblue"><br>LPS[1,1] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[1,2] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[1,3] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[1,4] = 1</td>
			<td align="center" bgcolor="lightyellow"><br>LPS[1,5] = 1</td>
			<td align="center" bgcolor="lightpink"><br>LPS[1,6] = 3</td>
			<td align="center" bgcolor="skyblue"></td>
			<td align="center" bgcolor="gold"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 2</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[2,2] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[2,3] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[2,4] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[2,5] = 1</td>
			<td align="center" bgcolor="lightyellow"><br>LPS[2,6] = 3</td>
			<td align="center" bgcolor="lightpink"><br>LPS[2,7] = 3</td>
			<td align="center" bgcolor="skyblue"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 3</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[3,3] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[3,4] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[3,5] = 1</td>
			<td align="center" bgcolor="orange"><br><b>LPS[3,6] = 3</b></td>
			<td align="center" bgcolor="lightyellow"><br>LPS[3,7] = 3</td>
			<td align="center" bgcolor="lightpink"><br>LPS[3,8] = 3</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 4</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[4,4] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[4,5] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[4,6] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[4,7] = 1</td>
			<td align="center" bgcolor="lightyellow"><br>LPS[4,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 5</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[5,5] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[5,6] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[5,7] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[5,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 6</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[6,6] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[6,7] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[6,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 7</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[7,7] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[7,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 8</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[8,8] = 1<br><br></td>
		</tr>
	</table>
</ul>

<p><b>Iteration 7: len = 6; i = 1 to n-len; j = i+len = i+6;</b></p>
<p>In this iteration we consider seven consecutive chars. If the first (i<sup>th</sup>) and last (j<sup>th</sup>) 
chars are same, then</p>
<ul>
	LPS[i,j] = 2 + LPS[i+1,j-1] 
</ul>
<p>If they are not the same,</p>
<ul>
	<p>LPS[i,j] = max{LPS[i,j-1], LPS[i+1,j]}</p>
</ul>

<p>Let us now work out for the given example.</p>
<ul>
	<p>S[1..7] = axbcybz --> LPS[1,7] = max{LPS[1,6], LPS[2,7]} = max{3,3} = 3</p>
	<p>S[2..8] = xbcybza --> LPS[2,8] = max{LPS[2,7], LPS[3,8]} = max{3,3} = 3</p>
</ul>

<ul>
	<table border="1">
		<tr bgcolor="lightgray">
			<td align="center"><br><b>i &nbsp; \ &nbsp; j</b><br><br></td>
			<td align="center">&nbsp;<b>j = 1</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 2</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 3</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 4</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 5</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 6</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 7</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 8</b>&nbsp;</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 1</b>&nbsp; &nbsp;</td>
			<td align="center" bgcolor="lightblue"><br>LPS[1,1] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[1,2] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[1,3] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[1,4] = 1</td>
			<td align="center" bgcolor="lightyellow"><br>LPS[1,5] = 1</td>
			<td align="center" bgcolor="lightpink"><br>LPS[1,6] = 3</td>
			<td align="center" bgcolor="skyblue"><br>LPS[1,7] = 3</td>
			<td align="center" bgcolor="gold"></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 2</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[2,2] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[2,3] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[2,4] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[2,5] = 1</td>
			<td align="center" bgcolor="lightyellow"><br>LPS[2,6] = 3</td>
			<td align="center" bgcolor="lightpink"><br>LPS[2,7] = 3</td>
			<td align="center" bgcolor="skyblue"><br>LPS[2,8] = 3</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 3</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[3,3] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[3,4] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[3,5] = 1</td>
			<td align="center" bgcolor="orange"><br><b>LPS[3,6] = 3</b></td>
			<td align="center" bgcolor="lightyellow"><br>LPS[3,7] = 3</td>
			<td align="center" bgcolor="lightpink"><br>LPS[3,8] = 3</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 4</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[4,4] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[4,5] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[4,6] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[4,7] = 1</td>
			<td align="center" bgcolor="lightyellow"><br>LPS[4,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 5</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[5,5] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[5,6] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[5,7] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[5,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 6</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[6,6] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[6,7] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[6,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 7</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[7,7] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[7,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 8</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[8,8] = 1<br><br></td>
		</tr>
	</table>
</ul>

<p><b>Iteration 8: len = 7; i = 1 to n-len; j = i+len = i+7;</b></p>
<p>In this iteration we consider eight consecutive chars. If the first (i<sup>th</sup>) and last (j<sup>th</sup>) 
chars are same, then</p>
<ul>
	LPS[i,j] = 2 + LPS[i+1,j-1] 
</ul>
<p>If they are not the same,</p>
<ul>
	<p>LPS[i,j] = max{LPS[i,j-1], LPS[i+1,j]}</p>
</ul>

<p>Let us now work out for the given example.</p>
<ul>
	<p>S[1..8] = axbcybza --> LPS[1,8] = 2 + LPS[2,7] = 2 + 3 = 5</p>
</ul>

<ul>
	<table border="1">
		<tr bgcolor="lightgray">
			<td align="center"><br><b>i &nbsp; \ &nbsp; j</b><br><br></td>
			<td align="center">&nbsp;<b>j = 1</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 2</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 3</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 4</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 5</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 6</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 7</b>&nbsp;</td>
			<td align="center">&nbsp;<b>j = 8</b>&nbsp;</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 1</b>&nbsp; &nbsp;</td>
			<td align="center" bgcolor="lightblue"><br>LPS[1,1] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[1,2] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[1,3] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[1,4] = 1</td>
			<td align="center" bgcolor="lightyellow"><br>LPS[1,5] = 1</td>
			<td align="center" bgcolor="lightpink"><br>LPS[1,6] = 3</td>
			<td align="center" bgcolor="skyblue"><br>LPS[1,7] = 3</td>
			<td align="center" bgcolor="gold"><br><b>LPS[1,8] = 5</b></td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 2</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[2,2] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[2,3] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[2,4] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[2,5] = 1</td>
			<td align="center" bgcolor="lightyellow"><br>LPS[2,6] = 3</td>
			<td align="center" bgcolor="lightpink"><br>LPS[2,7] = 3</td>
			<td align="center" bgcolor="skyblue"><br>LPS[2,8] = 3</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 3</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[3,3] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[3,4] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[3,5] = 1</td>
			<td align="center" bgcolor="orange"><br><b>LPS[3,6] = 3</b></td>
			<td align="center" bgcolor="lightyellow"><br>LPS[3,7] = 3</td>
			<td align="center" bgcolor="lightpink"><br>LPS[3,8] = 3</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 4</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[4,4] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[4,5] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[4,6] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[4,7] = 1</td>
			<td align="center" bgcolor="lightyellow"><br>LPS[4,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 5</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[5,5] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[5,6] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[5,7] = 1</td>
			<td align="center" bgcolor="orange"><br>LPS[5,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 6</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[6,6] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[6,7] = 1</td>
			<td align="center" bgcolor="cyan"><br>LPS[6,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 7</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[7,7] = 1<br><br></td>
			<td align="center" bgcolor="lightgreen"><br>LPS[7,8] = 1</td>
		</tr>
		<tr>
			<td bgcolor="lightgray">&nbsp; &nbsp;<b>i = 8</b>&nbsp; &nbsp;</td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td bgcolor="gray"></td>
			<td align="center" bgcolor="lightblue"><br>LPS[8,8] = 1<br><br></td>
		</tr>
	</table>
</ul>

<h4>Algorithm</h4>

<p>The dynamic programming algorithm for longest palindromic subsequence can be given as follows.</p>

<pre class="brush:java">
	int LPS[1..n][1..n];

	DPLPS(char S[1..n]) {
		for (i = 1; i &lt;= n; i++)
			LPS[i][i] = 1;

	  	for (len = 1; len &lt; n; len++) {
	  		for (i = 1; i &lt; n-len; i++) {
	  			j = i + len;
	  			if (S[j] == S[j]) 
	  				LPS[i][j] = 2 + LPS[i+1[j-1];
	  			else
	  				LPS[i][j] = max{LPS[i][j-1], LPS[i+1][j]}
	  		}
		}
		return LPS[1][n];
	}
</pre>

<p><b>Time complexity</b></p>

<p>There are 2 loops. The outerloop runs for n-1 times. The inner loop runs for at most n-1 times. Thus, the time 
complexity is O(n<sup>2</sup>).</p>

<h4>Exercise</h4>
<p>How do you determine the actual subsequence from the LPS[ ] [ ] table?</p>


   </div>
  </div>

<div id="navigation">
	<p><br><strong><a href="../index.html" target="_blank">Home</a></strong></p>
    <ul>
      <li><a href="01_Intro.html" target="_blank">Why algorithm design matters?</a></li>
      <li><a href="02_Analysis.html" target="_blank">Analyzing algorithms</a></li>
      <li><a href="03_Asymptotics.html" target="_blank">Asymptotic notations</a></li>
      <li><a href="04_Masters.html" target="_blank">Master&#39;s method</a></li>
      <li><a href="05_Quadratic_sorting.html" target="_blank">Quadratic-time sorting</a></li>
      <li><a href="06_nlogn_sorting.html" target="_blank">NlogN sorting (Divide-and-Conquer)</a></li>
      <li><a href="07_Heapsort.html" target="_blank">Heap and Heap sort</a></li>
      <li><a href="08_Linear_sorting.html" target="_blank">Lower bound and Linear-time sorting</a></li>
      <li><a href="09_Selection.html" target="_blank">Selection problem</a></li>
      <li><a href="10_Optimization_Problems.html" target="_blank">Optimization Problems</a></li>
      <li><a href="11_Task_Scheduling.html" target="_blank">Task Scheduling</a></li>
      <li><a href="12_Integer_Knapsack.html" target="_blank">Integer Knapsack</a></li>
      <li><a href="13_LCS.html" target="_blank">Longest Common Subsequence</a></li>
      <li><a href="14_LIS.html" target="_blank">Longest Increasing Subsequence</a></li>
      <li><a href="15_LPS.html" target="_blank">Longest Palindromic Subsequence</a></li>
      <li><a href="16_MSS.html" target="_blank">Maximum Subsequence Sum</a></li>
    </ul>
</div> 
 

  <div id="extra">
  </div>
  <div id="footer">
    <p>Send comments to swaminathanj@am.amrita.edu</p>
  </div>
</div>
</body>
</html>
